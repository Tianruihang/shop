微信开发

小程序 wx2e36ea9dad8a4e33 秘钥 a8a29a91f952b528975f3f2b9cf758c5

{"wechatConnectSettingItems":[{"clientType":"PC","appId":"wx2e36ea9dad8a4e33 ","appSecret":"a8a29a91f952b528975f3f2b9cf758c5"},{"clientType":"H5","appId":"wx2e36ea9dad8a4e33 ","appSecret":"a8a29a91f952b528975f3f2b9cf758c5"},{"clientType":"WECHAT_MP","appId":"wx2e36ea9dad8a4e33 ","appSecret":"a8a29a91f952b528975f3f2b9cf758c5"}]}

安装指令

docker run -d --name logstash -m 1500M --restart=always -p 5044:5044 -p 9600:9600 --privileged=true -e ES_JAVA_OPTS="-Duser.timezone=Asia/Shanghai" -v /usr/local/logstash/logstash.conf:/usr/share/logstash/pipeline/logstash.conf -v /usr/local/logstash/logstash.yml:/usr/share/logstash/config/logstash.yml logstash:8.5.2

```
cat > /usr/local/logstash/logstash.conf << EOF
input {
  tcp {
    mode => "server"
    host => "0.0.0.0"
    port => 5044
    codec => json_lines
  }
}
output {
  elasticsearch {
    hosts => "127.0.0.1:9200"
    index => "%{[spring.application.name]}-%{+YYYY.MM.dd}"
  }
}
EOF
```

```
cat > /usr/local/logstash/logstash.yml << EOF
http.host: "0.0.0.0"
xpack.monitoring.elasticsearch.hosts: [ "http://127.0.0.1:9200" ]
EOF
```



docker run --name elasticsearch -d -e ES_JAVA_OPTS="-Xms512m -Xmx912m" -e "discovery.type=single-node" -p 9200:9200 -p 9300:9300 elasticsearch:7.7.0

docker run -p 3306:3306 --name mysql --restart=always --privileged=true -v /usr/local/mysql/log:/var/log/mysql -v /usr/local/mysql/data:/var/lib/mysql -v /usr/local/mysql/conf:/etc/mysql -v /usr/local/mysql/mysql-files:/var/lib/mysql-files -v /etc/localtime:/etc/localtime:ro -e MYSQL_ROOT_PASSWORD=lilishop -d mysql:5.7.21



docker run -p 6379:6379 --name redis -v /usr/local/redis/redis.conf:/etc/redis/redis.conf -d redis redis-server /etc/redis/redis.conf --appendonly yes



docker run -d --restart=always --name rmqnamesrv --privileged=true -p 9876:9876  -v /usr/local/rocketmq/nameserver/logs:/root/logs -v /usr/local/rocketmq/nameserver/store:/root/store -e "MAX_POSSIBLE_HEAP=100000000" rocketmqinc/rocketmq sh mqnamesrv



docker run -d --restart=always --name rmqbroker --link rmqnamesrv:namesrv -p 10911:10911 -p 10909:10909 --privileged=true -v /usr/local/rocketmq/broker/logs:/root/logs -v /usr/local/rocketmq/broker/store:/root/store -v /usr/local/rocketmq/broker.conf:/opt/docker/rocketmq/broker.conf -e "NAMESRV_ADDR=namesrv:9876" -e "MAX_POSSIBLE_HEAP=200000000" rocketmqinc/rocketmq sh mqbroker -c /opt/docker/rocketmq/broker.conf

docker run -d --restart=always --name rmqadmin -e "JAVA_OPTS=-Drocketmq.namesrv.addr=101.126.5.141:9876 -Dcom.rocketmq.sendMessageWithVIPChannel=false" -p 18080:8080 pangliang/rocketmq-console-ng



 docker run -p 80:80 --name nginx -v /usr/local/nginx/conf/nginx.conf:/etc/nginx/nginx.conf -v /usr/local/nginx/conf/conf.d:/etc/nginx/conf.d -v /usr/local/nginx/log:/var/log/nginx -v /usr/local/nginx/html:/usr/share/nginx/html -d nginx:latest



java -jar -Xms128m -Xmx256m xx.jar



订单表

```java
String id; //
String UserId;//
int num; //数量
BigDecimal sellPrice; //价格
BigDecimal payPrice; //价格
String pms;//密码
int status;//订单状态 0 待支付 1 已支付 2 已退回 3 待支付
timeStamp createTime;//时间戳
TimeStamp payTime;//支付时间
int charge; //手续费
int payType;//订单类型  0 平价区交易 1 溢价区交易
String payImg;//支付截图
```

交易规则表

```java
String id;
BigDecimal minUsualPrice; //价格
BigDecimal maxUsualPrice; //价格
BigDecimal minOverPrice; //价格
BigDecimal maxOverPrice; //价格
BigDecimal charge; //手续费
String collectImg;//收款码
String collectUrl;//收款地址
String collectName;//交易所
BigDecimal receiptRebateFir;//收币返利
BigDecimal receiptRebateSec;//返利
BigDecimal receiptRebateThi;//返利
BigDecimal payRebate;//充币返利
BigDecimal Cashrebate;//提现返利	
BigDecimal rebate;//返利	
timeStamp startTime;//开始时间
timeStamp endTime;//关闭时间
timeStamp createTime;//开始时间
timeStamp updateTime;//关闭时间
int type;//交易类型

```

用户积分表

```java
int points; //积分
String grade;//等级
int num;//钻石
String userNum;//推荐人数
int type;//账号类型 0 普通会员 1:合伙人
String shareId; //分享人Id
String userPower;//算力
String teamPower;//团队算力
int dividend;//分红
String pag;//数据包 道具
timeStamp createTime;//时间戳
String trueName;//真实内容
String idCardNum;//身份证号码
String cardNum;//收款银行卡
String onImg;//身份证正面
String backImg;//身份证背面
String authImg;//手持身份证
String zfbImg;//支付宝收款码
String WeChatImg;//微信收款码
```

任务表

```java
String Id;//id
int type; //任务类型
String name;//任务名
String content;//详细内容
int stats;//任务状态
timeStamp createTime;//时间戳
timeStamp endTime;//截止时间戳
```

任务表与用户关系

```java
String Id;//id
String userId;//用户ID
String taskId;//任务Id
```

数据包

```java
String id;
int type;// 数据包类型
timeStamp createTime;//时间戳
timeStamp endTime;//截止时间戳
```

矿机表

```java
String id;//
String name;// 矿机名称
BigDecimal price;//矿机价格
int limitHours; //限制时间
int type;// 类型
BigDecimal hourPoints;//矿机每小时产币
BigDecimal sumPoints;// 总产币
int power;//算力
String payType;// 支付方式
```

用户矿机关联关系表

```java
String id;
String userId;
String MachineId;
Date createTime;
Date endTime;
```

用户充值

```java
String id;
String userId;
int type; //币种类型
int num;//充币数量
String fileImg;//上传凭证
```



代码实现:

buyer-api项目里面 order 文件夹



用户实名认证之后 每小时产生一个数据包 24小时不领取就过期:

每个小时定时任务生成数据包 每小时查询过期数据
